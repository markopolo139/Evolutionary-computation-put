\section{Algorithms}
\label{sec:pseudocode}

\subsection{Hybrid Evolutionary Algorithm (HEA)}

The Hybrid Evolutionary Algorithm combines a steady-state genetic algorithm with local search. It maintains a small population of elite solutions. New solutions are generated by recombining two parents and applying local search. The population is updated by replacing the worst individual with the offspring if the offspring is better and unique (to maintain diversity).

\begin{algorithm}[H]
    \caption{Hybrid Evolutionary Algorithm (HEA)}
    \begin{algorithmic}[1]
        \Require Time Limit $T_{max}$, Population Size $N_{pop}=20$, Problem Instance
        \Ensure Best Solution $S_{best}$

        \State \textbf{Initialization:}
        \State $Pop \gets \emptyset$
        \While{$|Pop| < N_{pop}$}
            \State $S \gets \textsc{RandomSolution}()$
            \State $S \gets \textsc{LocalSearch}(S)$
            \If{$S \notin Pop$}
                \State Add $S$ to $Pop$
            \EndIf
        \EndWhile
        \State $S_{best} \gets \arg\min_{S \in Pop} f(S)$

        \State \textbf{Main Loop:}
        \While{$Elapsed(t) < T_{max}$}
            \State Select parents $P_1, P_2$ uniformly at random from $Pop$
            
            \State \Comment{Recombination (Operator 1 or 2)}
            \State $C \gets \textsc{Recombine}(P_1, P_2)$
            
            \State \Comment{Improvement (optional depending on variant)}
            \State $C \gets \textsc{LocalSearch}(C)$
            
            \State Update $S_{best}$ if $f(C) < f(S_{best})$
            
            \State \Comment{Steady-State Update}
            \State $S_{worst} \gets \arg\max_{S \in Pop} f(S)$
            \If{$f(C) < f(S_{worst})$ \textbf{and} $C$ is unique in $Pop$}
                \State Replace $S_{worst}$ with $C$ in $Pop$
            \EndIf
        \EndWhile
        \State \Return $S_{best}$
    \end{algorithmic}
\end{algorithm}

\newpage
\subsection{Recombination Operators}

\subsubsection{Operator 1: Common Edges Recombination}
This operator extracts common path segments and reconnects them randomly.

\begin{algorithm}[H]
    \caption{Operator 1 (Common Edges)}
    \begin{algorithmic}[1]
        \Require Parents $P_1, P_2$, Target Length $L$
        \Ensure Offspring $C$

        \State $E_{common} \gets Edges(P_1) \cap Edges(P_2)$
        \State $Fragments \gets \textsc{BuildFragments}(P_1, E_{common})$
        
        \State \Comment{Include isolated common nodes}
        \For{$v \in (Nodes(P_1) \cap Nodes(P_2))$}
            \If{$v$ is not in any fragment}
                \State Add {$v$} to $Fragments$
            \EndIf
        \EndFor

        \State \Comment{Fill with random nodes if needed}
        \While{$CountNodes(Fragments) < L$}
            \State $v \gets \textsc{RandomAvailableNode}()$
            \State Add {$v$} to $Fragments$
        \EndWhile

        \State Shuffle $Fragments$
        \State $C \gets \emptyset$
        \For{$frag \in Fragments$}
            \State With probability 0.5 reverse $frag$
            \State Append $frag$ to $C$
        \EndFor
        
        \State \Return $C$
    \end{algorithmic}
\end{algorithm}

\subsubsection{Operator 2: Filter \& Repair}
This operator preserves the relative order and traversal direction of nodes from Parent 1, but keeps only those nodes that are also present in Parent 2. The solution is then repaired.

\begin{algorithm}[H]
    \caption{Operator 2 (Filter \& Repair)}
    \begin{algorithmic}[1]
        \Require Parent $P_1$ (Reference), Parent $P_2$ (Filter), Target Length $L$
        \Ensure Offspring $C$

        \State $S_{partial} \gets \emptyset$
        
        \State \Comment{Filter Step: Keep P1 nodes only if present in P2}
        \For{$u \in P_1$}
            \If{$u \in Nodes(P_2)$}
                \State Add $u$ to $S_{partial}$
                \Comment{Preserves order from $P_1$}
            \EndIf
        \EndFor

        \State \Comment{Repair Step: Weighted Regret Heuristic}
        \State $C \gets \textsc{GreedyInsertWeightedRegret}(S_{partial}, TargetLength=L)$
        
        \State \Return $C$
    \end{algorithmic}
\end{algorithm}
