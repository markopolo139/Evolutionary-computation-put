\section{Algorithms}
\label{sec:pseudocode}

\subsection{Edge Recombination Crossover}
The crossover operator constructs an offspring by prioritizing edges that exist in the parent solutions. It maintains an adjacency map of neighbors from both parents and greedily selects the next node based on the fewest remaining connections, preserving the structural features of the parents.

\begin{algorithm}[H]
    \caption{Edge Recombination Crossover}
    \begin{algorithmic}[1]
        \Require Parent $P_1$, Parent $P_2$
        \Ensure Offspring $Child$
        \State Build NeighborMap $M$ from edges in $P_1$ and $P_2$
        \State $Child \gets \emptyset$, $Current \gets P_1[0]$
        \State Append $Current$ to $Child$, Mark $Current$ as visited
        \While{$|Child| < |P_1|$}
            \State $Candidates \gets M[Current] \setminus Visited$
            \If{$Candidates \neq \emptyset$}
                \State $Next \gets \arg\min_{n \in Candidates} \{ |M[n] \setminus Visited| \}$
                \If{tie in neighbors count}
                    \State Break tie with shortest distance $D[Current][n]$
                \EndIf
            \Else
                \State $Next \gets$ Random unvisited node
            \EndIf
            \State $Current \gets Next$
            \State Append $Current$ to $Child$, Mark $Current$ as visited
        \EndWhile
        \State \Return $Child$
    \end{algorithmic}
\end{algorithm}

\newpage

\subsection{Double Bridge Mutation}
The mutation operator introduces large-scale perturbations to escape local optima. It applies a random non-sequential 4-opt move (Double Bridge), splitting the tour into four segments and reconnecting them in a scrambled order ($S_1-S_2-S_3-S_4 \to S_1-S_4-S_3-S_2$).

\begin{algorithm}[H]
    \caption{Double Bridge Mutation}
    \begin{algorithmic}[1]
        \Require Solution $S$
        \Ensure Mutated Solution $S'$
        \State Select 3 random cut points $c_1 < c_2 < c_3$ in $S$
        \State Define segments: 
        \State 	$Seg_1 \gets S[0 \dots c_1-1]$
        \State 	$Seg_2 \gets S[c_1 \dots c_2-1]$
        \State 	$Seg_3 \gets S[c_2 \dots c_3-1]$
        \State 	$Seg_4 \gets S[c_3 \dots end]$
        \State $S' \gets Seg_1 + Seg_4 + Seg_3 + Seg_2$
        \State \Return $S'$
    \end{algorithmic}
\end{algorithm}

\newpage

\subsection{Optimized Hybrid Evolutionary Algorithm}
Here the biggest difference is using Binary Tournament to pick the first parent for recombination and the island restart after stagnation with best solution preservation. 
\begin{algorithm}[H]
    \caption{Optimized Hybrid Evolutionary Algorithm}
    \begin{algorithmic}[1]
        \Require Time Limit $T_{max}$, Population Size $N=20$, Candidates $K=40$
        \Ensure Best Solution $S_{best}$

        \State \textbf{Initialization:}
        \State $Pop \gets \emptyset$
        \While{$|Pop| < N$}
            \State $S \gets \textsc{RandomSolution}()$
            \State $S \gets \textsc{FastLocalSearch}(S)$
            \If{$f(S) \notin \{f(P) \mid P \in Pop\}$}
                \State $Pop \gets Pop \cup \{S\}$
            \EndIf
        \EndWhile
        \State $S_{best} \gets \textsc{GetBest}(Pop)$
        \State $Stagnation \gets 0$

        \State \textbf{Main Loop:}
        \While{$Elapsed(t) < T_{max}$}
            \State $P_1 \gets \textsc{BinaryTournament}(Pop)$
            \State $P_2 \gets \textsc{Random}(Pop \setminus \{P_1\})$

            \State $C \gets \textsc{EdgeRecombinationCrossover}(P_1, P_2)$

            \If{$Rand(0,1) < 0.05$}
                \State $C \gets \textsc{DoubleBridgeMutation}(C)$
            \EndIf

            \State $C \gets \textsc{FastLocalSearch}(C)$

            \State \Comment{Steady-State Replacement with Diversity Check}
            \If{$f(C) \notin \{f(P) \mid P \in Pop\}$}
                \If{$f(C) < f(\textsc{Worst}(Pop))$}
                    \State Replace $\textsc{Worst}(Pop)$ with $C$
                    \If{$f(C) < f(S_{best})$}
                        \State $S_{best} \gets C$
                        \State $Stagnation \gets 0$
                    \EndIf
                \EndIf
            \Else
                \State $Stagnation \gets Stagnation + 1$
            \EndIf

            \State \Comment{Cataclysm Restart}
            \If{$Stagnation > 300$}
                \State $Pop \gets \{S_{best}\}$
                \While{$|Pop| < N$}
                    \State $S \gets \textsc{RandomSolution}()$
                    \State $S \gets \textsc{FastLocalSearch}(S)$
                    \State $Pop \gets Pop \cup \{S\}$
                \EndWhile
                \State $Stagnation \gets 0$
            \EndIf
        \EndWhile
        \State \Return $S_{best}$
    \end{algorithmic}
\end{algorithm}